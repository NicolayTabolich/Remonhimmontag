<!DOCTYPE html>
<html lang="ru">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Вакансии</title>
   <style>
      * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
         font-family: 'Arial', sans-serif;
      }

      body {
         background-color: #f5f5f5;
         padding: 20px;
      }

      .vacancy-container {
         max-width: 1200px;
         margin: 0 auto;
         background: white;
         border-radius: 10px;
         box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
         overflow: hidden;
      }

      .vacancy-content {
         display: flex;
         flex-wrap: wrap;
      }

      .text-side {
         flex: 1;
         min-width: 300px;
         padding: 40px;
         background-color: #f9f9f9;
      }

      .form-side {
         flex: 1;
         min-width: 300px;
         padding: 40px;
      }

      h1 {
         color: #333;
         margin-bottom: 20px;
         font-size: 28px;
      }

      p {
         color: #555;
         line-height: 1.6;
         margin-bottom: 20px;
      }

      .download-btn {
         display: inline-block;
         background-color: #2c5aa0;
         color: white;
         padding: 12px 24px;
         border-radius: 5px;
         text-decoration: none;
         font-weight: bold;
         margin-bottom: 30px;
         transition: background-color 0.3s;
      }

      .download-btn:hover {
         background-color: #1e3d72;
      }

      .form-group {
         margin-bottom: 20px;
      }

      .file-label {
         display: inline-block;
         background-color: #f0f0f0;
         color: #333;
         padding: 12px 24px;
         border-radius: 5px;
         cursor: pointer;
         font-weight: bold;
         border: 1px solid #ddd;
         transition: background-color 0.3s;
      }

      .file-label:hover {
         background-color: #e0e0e0;
      }

      #file-input {
         display: none;
      }

      .file-info {
         margin-top: 10px;
         display: none;
         align-items: center;
         background-color: #f9f9f9;
         padding: 10px 15px;
         border-radius: 5px;
         border: 1px solid #ddd;
      }

      .file-name {
         flex: 1;
         color: #333;
      }

      .remove-file {
         color: #ff4d4d;
         cursor: pointer;
         font-weight: bold;
         font-size: 18px;
      }

      .checkbox-group {
         margin: 25px 0;
      }

      .checkbox-label {
         display: flex;
         align-items: center;
         cursor: pointer;
      }

      .checkbox-label input {
         margin-right: 10px;
      }

      .submit-btn {
         background-color: #2c5aa0;
         color: white;
         border: none;
         padding: 12px 30px;
         border-radius: 5px;
         font-weight: bold;
         cursor: pointer;
         transition: background-color 0.3s;
         width: 100%;
      }

      .submit-btn:hover {
         background-color: #1e3d72;
      }

      .submit-btn:disabled {
         background-color: #cccccc;
         cursor: not-allowed;
      }

      .message {
         padding: 10px;
         margin-top: 15px;
         border-radius: 5px;
         text-align: center;
         display: none;
      }

      .success {
         background-color: #d4edda;
         color: #155724;
         border: 1px solid #c3e6cb;
      }

      .error {
         background-color: #f8d7da;
         color: #721c24;
         border: 1px solid #f5c6cb;
      }

      @media (max-width: 768px) {
         .vacancy-content {
            flex-direction: column;
         }

         .text-side,
         .form-side {
            padding: 25px;
         }
      }
   </style>
</head>

<body>
   <div class="vacancy-container">
      <div class="vacancy-content">
         <div class="text-side">
            <h1>Мы ждем Вас в нашей большой и дружной команде</h1>
            <p>Скачайте, заполните и отправьте нам ваше резюме и наши специалисты обязательно Вам перезвонят.</p>
            <a href="resume.docx" class="download-btn" id="download-btn">СКАЧАТЬ РЕЗЮМЕ</a>

            <!-- Информация о скачивании файла -->
            <div id="download-message" class="message"></div>
         </div>

         <div class="form-side">
            <form id="resume-form" enctype="multipart/form-data">
               <div class="form-group">
                  <label for="file-input" class="file-label">ВЫБРАТЬ ФАЙЛ</label>
                  <input type="file" id="file-input" name="resume" accept=".doc,.docx,.pdf,.txt,.rtf" required>
                  <div class="file-info" id="file-info">
                     <span class="file-name" id="file-name"></span>
                     <span class="remove-file" id="remove-file">×</span>
                  </div>
               </div>

               <div class="checkbox-group">
                  <label class="checkbox-label">
                     <input type="checkbox" id="agreement" name="agreement" required>
                     <span>Я даю согласие на обработку персональных данных</span>
                  </label>
               </div>

               <button type="submit" class="submit-btn" id="submit-btn" disabled>ОТПРАВИТЬ</button>

               <!-- Сообщения об отправке формы -->
               <div id="form-message" class="message"></div>
            </form>
         </div>
      </div>
   </div>

   <script>
      document.addEventListener('DOMContentLoaded', function () {
         const fileInput = document.getElementById('file-input');
         const fileInfo = document.getElementById('file-info');
         const fileName = document.getElementById('file-name');
         const removeFile = document.getElementById('remove-file');
         const agreement = document.getElementById('agreement');
         const submitBtn = document.getElementById('submit-btn');
         const form = document.getElementById('resume-form');
         const formMessage = document.getElementById('form-message');
         const downloadBtn = document.getElementById('download-btn');
         const downloadMessage = document.getElementById('download-message');

         // Показываем сообщение о готовности скачать файл
         downloadMessage.textContent = 'Файл резюме готов к скачиванию';
         downloadMessage.className = 'message success';
         downloadMessage.style.display = 'block';

         // Обработчик выбора файла
         fileInput.addEventListener('change', function () {
            if (this.files && this.files[0]) {
               // Проверяем размер файла (максимум 5MB)
               if (this.files[0].size > 5 * 1024 * 1024) {
                  formMessage.textContent = 'Файл слишком большой. Максимальный размер - 5MB.';
                  formMessage.className = 'message error';
                  formMessage.style.display = 'block';
                  this.value = '';
                  return;
               }

               fileName.textContent = this.files[0].name;
               fileInfo.style.display = 'flex';
               checkFormValidity();

               // Скрываем сообщения об ошибках при успешном выборе файла
               formMessage.style.display = 'none';
            }
         });

         // Обработчик удаления файла
         removeFile.addEventListener('click', function () {
            fileInput.value = '';
            fileInfo.style.display = 'none';
            checkFormValidity();
         });

         // Обработчик изменения состояния чекбокса
         agreement.addEventListener('change', checkFormValidity);

         // Проверка валидности формы
         function checkFormValidity() {
            const isFileSelected = fileInput.files.length > 0;
            const isAgreementChecked = agreement.checked;

            submitBtn.disabled = !(isFileSelected && isAgreementChecked);
         }

         // Обработчик отправки формы
         form.addEventListener('submit', function (e) {
            e.preventDefault();

            // Показываем пользователю, что идет отправка
            submitBtn.disabled = true;
            submitBtn.textContent = 'Отправка...';

            // Собираем данные формы
            const formData = new FormData(this);

            // Отправляем данные на сервер
            fetch('send_resume.php', {
               method: 'POST',
               body: formData
            })
               .then(response => {
                  if (!response.ok) {
                     throw new Error('Ошибка сети');
                  }
                  return response.text();
               })
               .then(data => {
                  // Пытаемся разобрать ответ как JSON
                  try {
                     const jsonData = JSON.parse(data);
                     if (jsonData.success) {
                        formMessage.textContent = jsonData.message;
                        formMessage.className = 'message success';

                        // Сброс формы
                        form.reset();
                        fileInfo.style.display = 'none';
                     } else {
                        formMessage.textContent = jsonData.message;
                        formMessage.className = 'message error';
                     }
                  } catch (e) {
                     // Если ответ не JSON, показываем как есть
                     if (data.includes('успешно')) {
                        formMessage.textContent = 'Ваше резюме успешно отправлено! Мы свяжемся с Вами в ближайшее время.';
                        formMessage.className = 'message success';

                        // Сброс формы
                        form.reset();
                        fileInfo.style.display = 'none';
                     } else {
                        formMessage.textContent = 'Произошла ошибка при отправке. Пожалуйста, попробуйте еще раз.';
                        formMessage.className = 'message error';
                     }
                  }

                  formMessage.style.display = 'block';
               })
               .catch(error => {
                  formMessage.textContent = 'Произошла ошибка при отправке. Пожалуйста, попробуйте еще раз.';
                  formMessage.className = 'message error';
                  formMessage.style.display = 'block';
                  console.error('Error:', error);
               })
               .finally(() => {
                  // Восстанавливаем кнопку
                  submitBtn.disabled = false;
                  submitBtn.textContent = 'ОТПРАВИТЬ';
                  checkFormValidity();
               });
         });
      });
   </script>
</body>

</html>